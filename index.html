<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ãƒ«ãƒ«ã‚¤ã‚¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js">  // ğŸŒŠ æ·±æµ·éŸ³ï¼ˆ40Hzï¼‰

  function playDeepSound() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = 'sine';
    osc.frequency.value = 40;
    gain.gain.value = 0.2;
    osc.connect(gain).connect(audioCtx.destination);
    osc.start();
    return osc;
  }

  function triggerEvent() {
    document.body.classList.add('event-dark','shake');
    document.getElementById('scanlines').style.display = 'block';
    const osc = playDeepSound();

    setTimeout(() => {
      document.body.classList.remove('event-dark','shake');
      document.getElementById('scanlines').style.display = 'none';
      osc.stop();
      audioCtx.close();
    }, 4000);
  }

  // â³ å®šæœŸã‚¤ãƒ™ãƒ³ãƒˆï¼ˆ3ã€œ6åˆ†ãƒ©ãƒ³ãƒ€ãƒ ï¼‰
  function scheduleEvent() {
    const next = Math.random() * 180000 + 180000;
    setTimeout(() => {
      triggerEvent();
      scheduleEvent();
    }, next);
  }
  scheduleEvent();
  // ğŸ•¯ å®šæœŸçš„ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæ·±æµ·æ¥è§¦ï¼‰
  const crt = document.getElementById('crt');


  function playDeepSeaSound() {
    audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();

    osc.type = 'sine';
    osc.frequency.value = 40; // 40Hz æ·±æµ·éŸ³
    gain.gain.value = 0.15;

    osc.connect(gain);
    gain.connect(audioCtx.destination);

    osc.start();
    setTimeout(() => osc.stop(), 4000);
  }

  function deepSeaEvent() {
    document.body.classList.add('event-dark','event-shake');
    crt.classList.add('active');
    playDeepSeaSound();

    setTimeout(() => {
      document.body.classList.remove('event-dark','event-shake');
      crt.classList.remove('active');
    }, 5000);
  }

  // â³ ä¸å®šæœŸã«ç™ºç”Ÿï¼ˆ3ã€œ7åˆ†ï¼‰
  function scheduleEvent() {
    const next = Math.random() * (420000 - 180000) + 180000;
    setTimeout(() => {
      deepSeaEvent();
      scheduleEvent();
    }, next);
  }

  scheduleEvent();
</script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    body { margin:0; background:#020403; color:#cfd8c3; font-family:"Yu Mincho",serif; }
    header { padding:16px; text-align:center; border-bottom:1px solid #133; }
    #board {  height: 520px;  overflow-y: auto; border: 1px solid #233;  padding:10px; margin: 30px;  margin-bottom: 10px;  background: rgba(0,0,0,0.5);}
   .post { border-bottom:1px dashed #244; padding:12px 0; }
    .time { font-size:11px; opacity:0.6; }
    #form { max-width:800px; margin:24px auto; padding:16px; border:1px solid #133; }
    textarea { width:100%; height:80px; background:#000; color:#cfd8c3; border:1px solid #244; }
    button { margin-top:8px; background:#021; color:#cfd8c3; border:1px solid #355; padding:6px 12px; }
    /* ===== ç•°å¸¸ã‚¤ãƒ™ãƒ³ãƒˆæ¼”å‡º ===== */
body.anomaly {
  animation: screenShake 0.1s infinite;
  background-color: #300;
  filter: contrast(200%) saturate(300%);
}/* å…±é€š */
body[class^="anomaly"] {
  transition: all 0.2s;
}

/* èµ¤è»¢ã®ã¿ */
body.anomaly-red::before {
  content:'';
  position:fixed;
  inset:0;
  background:rgba(180,0,0,0.6);
  z-index:9998;
  pointer-events:none;
}

/* æºã‚Œã®ã¿ */
body.anomaly-shake {
  animation: screenShake 0.1s infinite;
}

/* CRTèµ°æŸ»ç·š */
body.anomaly-crt::after {
  content:'';
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.04) 16px,
    rgba(255,255,255,0.04) 24px,
    rgba(0,0,0,0) 8px,
    rgba(0,0,0,0) 30px
  );
  z-index:9999;
  pointer-events:none;
  animation: scanline 0.15s linear infinite;
}

/* å…¨éƒ¨ç››ã‚Šï¼ˆãƒ¬ã‚¢ï¼‰ */
body.anomaly-full {
  animation: screenShake 0.08s infinite;
  filter: contrast(200%) saturate(300%);
}
body.anomaly-full::before {
  content:'';
  position:fixed;
  inset:0;
  background:rgba(200,0,0,0.7);
  z-index:9998;
}
body.anomaly-full::after {
  content:'';
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.05) 0px,
    rgba(255,255,255,0.05) 1px,
    rgba(0,0,0,0) 2px,
    rgba(0,0,0,0) 4px
  );
  z-index:9999;
}

@keyframes screenShake {
  0% { transform:translate(0,0); }
  25% { transform:translate(2px,-2px); }
  50% { transform:translate(-2px,2px); }
  75% { transform:translate(2px,2px); }
  100% { transform:translate(0,0); }
}

@keyframes scanline {
  from { background-position:0 0; }
  to { background-position:0 4px; }
}

    .noise { position:fixed; inset:0; pointer-events:none; opacity:0.05;
      background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="4"/></filter><rect width="200" height="200" filter="url(%23n)"/></svg>'); }
    /* ğŸ‘ ã‚¤ãƒ™ãƒ³ãƒˆæ¼”å‡º */
    .event-dark {
      animation: darken 0.5s forwards;
    }
    @keyframes darken { to { background:#000; } }

    .shake {
      animation: shake 0.1s infinite;
    }
    @keyframes shake {
      0% { transform: translate(0,0); }
      25% { transform: translate(2px,-2px); }
      50% { transform: translate(-2px,2px); }
      75% { transform: translate(2px,2px); }
      100% { transform: translate(0,0); }
    }

    .scanlines {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,0.03) 0px,
        rgba(255,255,255,0.03) 1px,
        transparent 2px,
        transparent 4px
      );
      opacity: 0.4;
      mix-blend-mode: overlay;
    }
@keyframes shake {0%{transform:translate(0)}20%{transform:translate(-5px,3px)}40%{transform:translate(5px,-3px)}60%{transform:translate(-3px,5px)}80%{transform:translate(3px,-5px)}100%{transform:translate(0)}}
    .event-dark { background:#000 !important; }
    .event-shake { animation: shake 0.1s infinite; }
    .crt {
      position: fixed; inset:0; pointer-events:none;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,0.03) 0px,
        rgba(0,0,0,0.03) 1px,
        rgba(0,0,0,0.06) 2px
      );
      mix-blend-mode: overlay;
      opacity:0;
    }
    .crt.active { opacity:1; }
  </style>

<div class="scanlines" id="scanlines" style="display:none"></div>
</head>
<body>
<header>
  <h1>R'lyeh / ãƒ«ãƒ«ã‚¤ã‚¨</h1>
  <div style="font-size:12px;opacity:.7">ã„ãªããªã£ã¦æ¬²ã—ã„äººã¯ç¥éš ã—åˆã‚ã›ã¾ã—ã‚‡ã†</div>
</header>

<div id="board"></div>

<div id="form">
  <div>æ›¸ãè¾¼ã¿ï¼š</div>
  <textarea id="input"></textarea>
  <button onclick="sendPost()">é€ä¿¡</button>
</div>

<div class="noise"></div>
<div class="crt" id="crt"></div>

<script>
    // å³ã‚¯ãƒªãƒƒã‚¯ç¦æ­¢
  document.addEventListener('contextmenu', function (e) {
    e.preventDefault();
  });
  /* ğŸ”¥ Firebaseè¨­å®šï¼ˆè‡ªåˆ†ã®ã‚‚ã®ã«å·®ã—æ›¿ãˆï¼‰ */
const firebaseConfig = {
  apiKey: "AIzaSyC1IK8k7yfu7rEzGBsQHl9CLHLy1aCwYTE",
  authDomain: "rlyeh-board.firebaseapp.com",
  databaseURL: "https://rlyeh-board-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "rlyeh-board",
  storageBucket: "rlyeh-board.firebasestorage.app",
  messagingSenderId: "107455035572",
  appId: "1:107455035572:web:2128ec27aefe2afe6f3fe1"
};

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const postsRef = db.ref('posts');

  const board = document.getElementById('board');

function addPost(text) {
  const div = document.createElement('div');
  div.className = 'post';
  div.innerHTML = `<div>${text}</div>`;
  board.prepend(div);
}


  function sendPost() {
    const input = document.getElementById('input');
    if (!input.value.trim()) return;

    postsRef.push({
      text: input.value,

    });

    localStorage.setItem('rlyeh_marked', 'true');
    input.value = '';
  }

  // ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å—ä¿¡
  postsRef.limitToLast(30).on('child_added', snapshot => {
    const data = snapshot.val();
    addPost(data.text);
  });

  // ğŸ‘ è‡ªå‹•æŠ•ç¨¿ï¼ˆæ­£ä½“ä¸æ˜ï¼‰
  const autoPosts = [

'ä½è—¤ä¸€éƒ','éˆ´æœ¨å¤ªéƒ','é«˜æ©‹èŠ±å­','ç”°ä¸­å¥','ä¼Šè—¤ç¾å’²','æ¸¡è¾ºç¿”','å±±æœ¬å½©','ä¸­æ‘ç›´æ¨¹','å°æ—çœŸç”±','åŠ è—¤èª ',
'å‰ç”°æ‚ æ–—','å±±ç”°å¥ˆã€…','ä½ã€…æœ¨äº®','å±±å£æ„›','æ¾æœ¬å¤§è¼”','äº•ä¸Šé‡Œå¥ˆ','æœ¨æ‘æ‹“ä¹Ÿ','æ—å„ªå­','æ¸…æ°´èˆª','æ–è—¤æµ',
'æ£®ç”°å‰›','æ± ç”°ç¾å„ª','æ©‹æœ¬æ¶¼','é˜¿éƒ¨çœŸç´','çŸ³å·ä¿Šä»‹','å‰ç”°ç”±ç´€','è—¤ç”°å¥å¤ª','å°å·æ²™ç¹”','å²¡ç”°æ‚ ','å¾Œè—¤ç†æ²™',

'ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ','ä¸€ç´¢ å…‰é‡Œ',

];
  setInterval(() => {
    postsRef.push({
      text: autoPosts[Math.floor(Math.random()*autoPosts.length)],
    });
  }, 120000);
  // === æ·±æµ·éŸ³ï¼ˆ40Hzï¼‰ ===
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  function startDeepSea() {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = 'sine';
    osc.frequency.value = 190;
    gain.gain.value = 0.05;
    osc.connect(gain).connect(audioCtx.destination);
    osc.start();
  }
  document.body.addEventListener('click', () => { if (audioCtx.state !== 'running') startDeepSea(); }, { once:true });

  // === ç•°å¸¸ã‚¤ãƒ™ãƒ³ãƒˆ ===
const anomalySounds = [
  'ææ€–.mp3',
  'ã†ãªã‚Š.mp3',
  'ã‚¯ãƒˆã‚¥ãƒ«ãƒ•ãƒ»ãƒ•ã‚¿ã‚°ãƒ³.mp3',
  'ã‚´ã‚´ã‚´ã‚´.mp3',
  'ææ€–(10)ä¸‡èƒ½.mp3',
  'åœ°éœ‡é­”æ³•1.mp3',
  'æ·±æµ·.mp3'
];


function anomalyEvent() {
  // 60%ã§ç™ºç”Ÿ
  if (Math.random() > 0.6) return;

  const effects = [
    'anomaly-red',
    'anomaly-shake',
    'anomaly-crt',
    'anomaly-full'
  ];

  const effect = effects[Math.floor(Math.random() * effects.length)];
  document.body.classList.add(effect);

  // ğŸ”Š ãƒ©ãƒ³ãƒ€ãƒ ç•°å¸¸éŸ³
  const soundSrc = anomalySounds[Math.floor(Math.random() * anomalySounds.length)];
  const sound = new Audio(soundSrc);
  sound.volume = 0.4;
  sound.play();

  // æŒç¶šæ™‚é–“ã‚‚ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆ2ã€œ6ç§’ï¼‰
  const duration = 11000 + Math.random() * 14000;

  setTimeout(() => {
    document.body.classList.remove(effect);
    sound.pause();
    sound.currentTime = 0;
  }, duration);
}
// 30ã€œ90ç§’ã®ãƒ©ãƒ³ãƒ€ãƒ é–“éš”ã§ç™ºç”Ÿ
function scheduleAnomaly() {
  const next = 600000 + Math.random() * 600000;
  setTimeout(() => {
    anomalyEvent();
    scheduleAnomaly();
  }, next);
}

scheduleAnomaly();






  setInterval(anomalyEvent, 90000);

  


  
</script>
</body>
</html>
